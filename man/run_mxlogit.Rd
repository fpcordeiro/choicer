% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mxlogit_utils.R
\name{run_mxlogit}
\alias{run_mxlogit}
\title{Runs mixed logit estimation}
\usage{
run_mxlogit(
  data = NULL,
  id_col = NULL,
  alt_col = NULL,
  choice_col = NULL,
  covariate_cols = NULL,
  random_var_cols = NULL,
  input_data = NULL,
  eta_draws = NULL,
  S = 100L,
  rc_dist = NULL,
  rc_mean = FALSE,
  rc_correlation = FALSE,
  use_asc = TRUE,
  theta_init = NULL,
  optimizer = NULL,
  control = list(),
  weights = NULL,
  outside_opt_label = NULL,
  include_outside_option = FALSE,
  keep_data = TRUE,
  nloptr_opts = NULL
)
}
\arguments{
\item{data}{Data frame containing choice data (convenience workflow).
Mutually exclusive with \code{input_data}.}

\item{id_col}{Name of the column identifying choice situations.}

\item{alt_col}{Name of the column identifying alternatives.}

\item{choice_col}{Name of the column indicating chosen alternative (1/0).}

\item{covariate_cols}{Vector of column names for fixed covariates.}

\item{random_var_cols}{Vector of column names for random coefficients.}

\item{input_data}{List output from \code{\link{prepare_mxl_data}} (advanced
workflow). Mutually exclusive with \code{data}.}

\item{eta_draws}{Array of shape K_w x S x N with standard normal draws.
Required for the advanced workflow; auto-generated from \code{S} in the
convenience workflow.}

\item{S}{Integer number of Halton draws per individual (convenience workflow
only). Default 100.}

\item{rc_dist}{Integer vector indicating distribution of random coefficients
(0 = normal, 1 = log-normal). Default: all normal.}

\item{rc_mean}{Logical indicating whether to estimate means for random
coefficients.}

\item{rc_correlation}{Logical indicating whether random coefficients are
correlated (convenience workflow). Ignored when \code{input_data} is used
(taken from the prepared data).}

\item{use_asc}{Logical indicating whether to include alternative-specific
constants.}

\item{theta_init}{Initial parameter vector. If \code{NULL}, zeros are used.}

\item{optimizer}{Optimizer to use: \code{"nloptr"} (default), \code{"optim"},
or a custom function. See \code{\link{run_mnlogit}} for details.}

\item{control}{List of optimizer-specific control parameters.}

\item{weights}{Optional weight vector (convenience workflow). If \code{NULL},
equal weights are used.}

\item{outside_opt_label}{Label for the outside option (convenience workflow).}

\item{include_outside_option}{Logical whether to include an outside option
(convenience workflow).}

\item{keep_data}{Logical. If \code{TRUE} (default), stores prepared data in
the returned object for post-estimation functions.}

\item{nloptr_opts}{Deprecated. Use \code{optimizer} and \code{control}
instead.}
}
\value{
A \code{choicer_mxl} object (inherits from \code{choicer_fit}).
Standard S3 methods available: \code{summary()}, \code{coef()},
\code{vcov()}, \code{logLik()}, \code{AIC()}, \code{BIC()},
\code{nobs()}.
}
\description{
Estimates a mixed logit model via simulated maximum likelihood.
}
\details{
Two workflows are supported:
\describe{
\item{Convenience}{Supply \code{data} and column names. Data preparation
(\code{\link{prepare_mxl_data}}) and Halton draw generation
(\code{\link{get_halton_normals}}) are handled automatically.}
\item{Advanced}{Call \code{\link{prepare_mxl_data}} and
\code{\link{get_halton_normals}} yourself, then pass the results via
\code{input_data} and \code{eta_draws}.}
}
}
\examples{
\donttest{
library(data.table)
set.seed(42)
N <- 100; J <- 3
dt <- data.table(id = rep(1:N, each = J), alt = rep(1:J, N))
dt[, `:=`(x1 = rnorm(.N), w1 = rnorm(.N), w2 = rnorm(.N))]
dt[, choice := 0L]
dt[, choice := sample(c(1L, rep(0L, J - 1))), by = id]

fit <- run_mxlogit(
  data = dt, id_col = "id", alt_col = "alt", choice_col = "choice",
  covariate_cols = "x1", random_var_cols = c("w1", "w2"), S = 50L
)
summary(fit)
}
}
