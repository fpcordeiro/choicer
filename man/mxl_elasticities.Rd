% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mxlogit_utils.R
\name{mxl_elasticities}
\alias{mxl_elasticities}
\title{Compute aggregate elasticities for mixed logit model}
\usage{
mxl_elasticities(
  opt_result,
  input_data,
  eta_draws,
  rc_dist,
  elast_var_idx,
  is_random_coef = FALSE,
  rc_mean = FALSE,
  use_asc = TRUE
)
}
\arguments{
\item{opt_result}{Result object from \code{run_mxlogit()} containing \verb{$solution}.}

\item{input_data}{List output from \code{prepare_mxl_data()}.}

\item{eta_draws}{Array of shape K_w x S x N with standard normal draws.}

\item{rc_dist}{Integer vector indicating distribution (0 = normal, 1 = log-normal).}

\item{elast_var_idx}{1-based index of variable for elasticity computation.
If \code{is_random_coef = FALSE}, this indexes into X columns. If \code{is_random_coef = TRUE},
this indexes into W columns.}

\item{is_random_coef}{Logical. \code{TRUE} if the variable has a random coefficient (is in W),
\code{FALSE} if it has a fixed coefficient (is in X). Default is \code{FALSE}.}

\item{rc_mean}{Logical indicating whether means were estimated for random coefficients.}

\item{use_asc}{Logical indicating whether ASCs were included in the model.}
}
\value{
A J x J elasticity matrix where entry (i, j) is the elasticity of P_i
with respect to the attribute of alternative j. Row and column names are set
from the alternative labels if available.
}
\description{
Computes the aggregate elasticity matrix (weighted average of individual
elasticities) for the Mixed Logit model. The elasticity E(i,j) represents
the percentage change in the probability of choosing alternative i when
the attribute of alternative j changes by 1\%.
}
\examples{
\donttest{
library(data.table)
set.seed(42)
N <- 100; J <- 3
dt <- data.table(id = rep(1:N, each = J), alt = rep(1:J, N))
dt[, `:=`(x1 = rnorm(.N), w1 = rnorm(.N))]
dt[, choice := 0L]
dt[, choice := sample(c(1L, rep(0L, J - 1))), by = id]
input <- prepare_mxl_data(dt, "id", "alt", "choice", "x1", "w1")
eta <- get_halton_normals(50, input$N, ncol(input$W))
fit <- run_mxlogit(input_data = input, eta_draws = eta)
elas <- mxl_elasticities(
  list(solution = coef(fit)), input, eta,
  rc_dist = rep(0L, ncol(input$W)), elast_var_idx = 1L
)
}
}
