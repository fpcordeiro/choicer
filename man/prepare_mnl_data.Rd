% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mnlogit_utils.R
\name{prepare_mnl_data}
\alias{prepare_mnl_data}
\title{Prepare inputs for \code{mnl_loglik_gradient_parallel()}}
\usage{
prepare_mnl_data(
  data,
  id_col,
  alt_col,
  choice_col,
  covariate_cols,
  weights = NULL,
  outside_opt_label = NULL,
  include_outside_option = FALSE
)
}
\arguments{
\item{data}{Data frame containing choice data.}

\item{id_col}{Name of the column identifying choice situations (individuals).}

\item{alt_col}{Name of the column identifying alternatives.}

\item{choice_col}{Name of the column indicating chosen alternative (1 = chosen, 0 = not chosen).}

\item{covariate_cols}{Vector of names of columns to be used as covariates.}

\item{weights}{Optional vector of weights for each choice situation. If \code{NULL}, equal weights are used.}

\item{outside_opt_label}{Label for the outside option (if any). If \code{NULL}, no outside option is assumed.}

\item{include_outside_option}{Logical indicating whether to include an outside option in the model.}
}
\value{
A list containing:
\itemize{
\item \code{X}: Design matrix (sum(M) x K).
\item \code{alt_idx}: Integer vector of alternative indices.
\item \code{choice_idx}: Integer vector of chosen alternative indices.
\item \code{M}: Integer vector with number of alternatives per choice situation.
\item \code{N}: Number of choice situations.
\item \code{weights}: Vector of weights.
\item \code{include_outside_option}: Logical flag.
\item \code{alt_mapping}: Data.table mapping alternatives to summary statistics.
\item \code{dropped_cols}: Names of columns dropped due to collinearity, if any.
}
}
\description{
Prepares and validates inputs for multinomial logit estimation routine.
}
\examples{
library(data.table)
set.seed(42)
N <- 50; J <- 3
dt <- data.table(id = rep(1:N, each = J), alt = rep(1:J, N))
dt[, `:=`(x1 = rnorm(.N), x2 = rnorm(.N))]
dt[, choice := 0L]
dt[, choice := sample(c(1L, rep(0L, J - 1))), by = id]
input <- prepare_mnl_data(dt, "id", "alt", "choice", c("x1", "x2"))
str(input$X)
input$alt_mapping
}
