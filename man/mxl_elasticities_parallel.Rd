% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{mxl_elasticities_parallel}
\alias{mxl_elasticities_parallel}
\title{Compute aggregate elasticities for mixed logit model}
\usage{
mxl_elasticities_parallel(
  theta,
  X,
  W,
  alt_idx,
  choice_idx,
  M,
  weights,
  eta_draws,
  rc_dist,
  elast_var_idx,
  is_random_coef,
  rc_correlation = TRUE,
  rc_mean = FALSE,
  use_asc = TRUE,
  include_outside_option = FALSE
)
}
\arguments{
\item{theta}{parameter vector (beta, [mu], L, delta)}

\item{X}{design matrix for fixed coefficients; sum(M_i) x K_x}

\item{W}{design matrix for random coefficients; sum(M_i) x K_w or J x K_w}

\item{alt_idx}{sum(M) x 1 vector with indices of alternatives; 1-based indexing}

\item{choice_idx}{N x 1 vector (kept for API consistency, not used)}

\item{M}{N x 1 vector with number of alternatives for each individual}

\item{weights}{N x 1 vector with weights for each observation}

\item{eta_draws}{Array with draws; K_w x S x N}

\item{rc_dist}{K_w vector indicating distribution (0=normal, 1=log-normal)}

\item{elast_var_idx}{1-based index of the variable for elasticity computation}

\item{is_random_coef}{TRUE if variable is in W (random coef), FALSE if in X (fixed coef)}

\item{rc_correlation}{whether random coefficients are correlated}

\item{rc_mean}{whether mu parameters are estimated}

\item{use_asc}{whether ASCs are included}

\item{include_outside_option}{whether outside option is included}
}
\value{
J x J matrix of aggregate elasticities
}
\description{
Computes the aggregate elasticity matrix (weighted average of individual
elasticities) for the Mixed Logit model. The elasticity E(i,j) represents
the percentage change in the probability of choosing alternative i when
the attribute of alternative j changes by 1\%.
}
\examples{
\donttest{
library(data.table)
set.seed(42)
N <- 50; J <- 3
dt <- data.table(id = rep(1:N, each = J), alt = rep(1:J, N))
dt[, `:=`(x1 = rnorm(.N), w1 = rnorm(.N))]
dt[, choice := 0L]
dt[, choice := sample(c(1L, rep(0L, J - 1))), by = id]
d <- prepare_mxl_data(dt, "id", "alt", "choice", "x1", "w1")
eta <- get_halton_normals(50, d$N, ncol(d$W))
fit <- run_mxlogit(input_data = d, eta_draws = eta)
elas <- mxl_elasticities_parallel(coef(fit), d$X, d$W, d$alt_idx,
  d$choice_idx, d$M, d$weights, eta, rc_dist = rep(0L, ncol(d$W)),
  elast_var_idx = 1L, is_random_coef = FALSE,
  rc_correlation = FALSE, rc_mean = FALSE)
elas
}
}
