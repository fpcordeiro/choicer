% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{mxl_hessian_parallel}
\alias{mxl_hessian_parallel}
\title{Analytical Hessian of the log-likelihood v2}
\usage{
mxl_hessian_parallel(
  theta,
  X,
  W,
  alt_idx,
  choice_idx,
  M,
  weights,
  eta_draws,
  rc_dist,
  rc_correlation = TRUE,
  rc_mean = FALSE,
  use_asc = TRUE,
  include_outside_option = FALSE
)
}
\arguments{
\item{theta}{vector collecting model parameters (beta, mu, L, delta (ASCs))}

\item{X}{design matrix for covariates with fixed coefficients; sum(M_i) x K_x}

\item{W}{design matrix for covariates with random coefficients; sum(M_i) x K_w or J x K_w}

\item{alt_idx}{sum(M) x 1 vector with indices of alternatives within each choice set; 1-based indexing}

\item{choice_idx}{N x 1 vector with indices of chosen alternatives; 1-based indexing relative to X; 0 is used if include_outside_option=True}

\item{M}{N x 1 vector with number of alternatives for each individual}

\item{weights}{N x 1 vector with weights for each observation}

\item{eta_draws}{Array with choice situation draws; K_w x S x N}

\item{rc_dist}{K_w x 1 integer vector indicating distribution of random coefficients: 0 = normal, 1 = log-normal}

\item{rc_correlation}{whether random coefficients should be correlated}

\item{rc_mean}{whether to estimate means for random coefficients.}

\item{use_asc}{whether to use alternative-specific constants.}

\item{include_outside_option}{whether to include outside option normalized to 0 (if so, the outside option is not included in the data)}
}
\value{
Hessian evaluated at input arguments
}
\description{
Computes the Hessian of the log-likelihood for the Mixed Logit model using
OpenMP for parallelization. Mirrors the parameters of mxl_loglik_gradient_parallel.
}
\note{
For log-normal random coefficients (rc_dist=1) with rc_mean=TRUE,
the distribution is a shifted log-normal: beta_k = exp(mu_k) + exp(L_k * eta),
where exp(mu_k) shifts the location and exp(L_k * eta) ~ LogNormal(0, sigma_k^2).
This differs from the textbook parameterization exp(mu_k + L_k * eta).
}
